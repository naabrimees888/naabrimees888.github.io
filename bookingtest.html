<!DOCTYPE html>
<html>
<head>
    <title>Add Event to Google Calendar</title>
</head>
<body>
    <h1>Add Event to Google Calendar</h1>
    <form id="eventForm">
        <label for="title">Title:</label><br>
        <input type="text" id="title" name="title"><br>
        <label for="date">Date:</label><br>
        <input type="date" id="date" name="date"><br>
        <label for="time">Time:</label><br>
        <input type="time" id="time" name="time"><br>
        <label for="location">Location:</label><br>
        <input type="text" id="location" name="location"><br>
        <button type="submit">Add to Calendar</button>
    </form>

    <script>
        function initClient() {
            gapi.client.init({
                apiKey: 'AIzaSyBdz8fT3UzafG34pkIIZBekHCiSEiWoqI4',
                clientId: '1062970372713-ov7r58nb41bi2g1qmmm49gc655bmk9sm.apps.googleusercontent.com',
                discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest'],
                scope: 'https://www.googleapis.com/auth/calendar.events'
            }).then(function() {
                console.log('Google Calendar API initialized');

                // Trigger sign-in when the page loads
                gapi.auth2.getAuthInstance().signIn();
            });
        }

        document.getElementById('eventForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const formData = new FormData(this);
            const title = formData.get('title');
            const date = formData.get('date');
            const time = formData.get('time');
            const location = formData.get('location');
            
            const eventDetails = {
                'summary': title,
                'start': {
                    'dateTime': date + 'T' + time + ':00',
                    'timeZone': 'Europe/Tallinn'
                },
                'end': {
                    'dateTime': date + 'T' + time + ':00',
                    'timeZone': 'Europe/Tallinn'
                },
                'location': location
            };

            gapi.client.calendar.events.insert({
                'calendarId': 'primary',
                'resource': eventDetails
            }).then(function(response) {
                console.log('Event created: ', response);
                alert('Event added to Google Calendar!');
            }, function(error) {
                console.error('Error adding event to Google Calendar:', error);
                alert('Error adding event to Google Calendar. Please try again later.');
            });
        });
    </script>

    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        gapi.load('client:auth2', initClient);
    </script>
</body>
</html>
